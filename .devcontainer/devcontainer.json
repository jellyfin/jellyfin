{
    "name": "Development Jellyfin Server",
    "image": "mcr.microsoft.com/devcontainers/dotnet:10.0-noble",
    "service": "app",
    "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",
    "containerUser": "vscode",
    "postCreateCommand": "sudo chown -R vscode:vscode /workspaces/",
    // restores nuget packages, installs the dotnet workloads and installs the dev https certificate
    "postStartCommand": "dotnet restore; dotnet workload update; dotnet dev-certs https --trust; bash \"./.devcontainer/install-ffmpeg.sh\"",
    // The previous way of installing extensions via the vs command dont work on selfhosted devcontainers
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-dotnettools.csharp",
                "editorconfig.editorconfig",
                "github.vscode-github-actions",
                "ms-dotnettools.vscode-dotnet-runtime",
                "ms-dotnettools.csdevkit",
                "alexcvzz.vscode-sqlite",
                "streetsidesoftware.code-spell-checker",
                "eamodio.gitlens",
                "redhat.vscode-xml"
            ]
        }
    },
    "features": {
        "ghcr.io/devcontainers/features/dotnet:2": {
            "version": "none",
            "dotnetRuntimeVersions": "10.0",
            "aspNetCoreRuntimeVersions": "10.0"
        },
        "ghcr.io/devcontainers-extra/features/apt-packages:1": {
            "preserve_apt_list": false,
            "packages": [
                "libfontconfig1"
            ]
        },
        "ghcr.io/devcontainers/features/docker-in-docker:2": {
            "dockerDashComposeVersion": "v2"
        },
        "ghcr.io/devcontainers/features/github-cli:1": {}
    },
    "hostRequirements": {
        "memory": "8gb",
        "cpus": 4
    }
}
